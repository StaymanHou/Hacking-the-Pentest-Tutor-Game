require "lib.util"

local Configuration = {}
Configuration.__index = Configuration
Configuration.configuration_name_map = {}
Configuration.all = {}

function Configuration.new(name)
  local self = setmetatable({}, Configuration)
  self.name = name
  Configuration.all[#(Configuration.all)+1] = self
  Configuration.configuration_name_map[name] = self
  return self
end

function Configuration.load()
  local f = assert(io.open("data/configurations.dat", "r"))
  local t = f:read("*all")
  f:close()
  local items = t:split("======================================================\n")
  for index = 2, #items do
    local item = items[index]
    local lines = item:split("\n")
    local name = lines[1]:gsub("Name: ", "")
    Configuration.new(name)
  end
  return Configuration.all
end

function Configuration.lookup(name)
  return Configuration.configuration_name_map[name]
end

return Configuration