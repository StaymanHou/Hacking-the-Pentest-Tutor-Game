require "lib.util"
if Vulnerability == nil then
  Vulnerability = require "lib.Vulnerability"
end
if Configuration == nil then
  Configuration = require "lib.Configuration"
end

local Action = {}
Action.__index = Action
Action.action_name_map = {}
Action.all = {}

function Action.new(name)
  local self = setmetatable({}, Action)
  self.name = name
  self.target_vulnerabilities = {}
  self.target_configurations = {}
  self.outcome = nil
  Action.all[#(Action.all)+1] = self
  Action.action_name_map[name] = self
  return self
end

function Action.lookup(name)
  return Action.action_name_map[name]
end

function Action:run(src_host, target)
  self.outcome.eval(target)
end

return Action