require "lib.util"

local Virus = {}
Virus.__index = Virus
Virus.virus_name_version_map = {}
Virus.all = {}

function Virus.new(name, version)
  local self = setmetatable({}, Virus)
  self.name = name
  self.version = version
  self.target_vulnerabilities = {}
  self.target_configurations = {}
  self.outcome = nil
  Virus.all[#(Virus.all)+1] = self
  if Virus.virus_name_version_map[name] == nil then
    Virus.virus_name_version_map[name] = {}
  end
  Virus.virus_name_version_map[name][version] = self
  return self
end

function Virus.lookup(name, version)
  return Virus.virus_name_version_map[name][version]
end

return Virus