require "lib.util"

local Virus = {}
Virus.__index = Virus
Virus.virus_name_map = {}
Virus.all = {}

function Virus.new(name)
  local self = setmetatable({}, Virus)
  self.name = name
  self.target_vulnerabilities = {}
  self.target_configurations = {}
  self.outcome = nil
  Virus.all[#(Virus.all)+1] = self
  Virus.virus_name_map[name] = self
  return self
end

function Virus.lookup(name)
  return Virus.virus_name_map[name]
end

return Virus