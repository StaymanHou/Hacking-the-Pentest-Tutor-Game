require "lib.util"

local Rootkit = {}
Rootkit.__index = Rootkit
Rootkit.rootkit_name_map = {}
Rootkit.all = {}

function Rootkit.new(name)
  local self = setmetatable({}, Rootkit)
  self.name = name
  self.outcome = nil
  Rootkit.all[#(Rootkit.all)+1] = self
  Rootkit.rootkit_name_map[name] = self
  return self
end

function Rootkit.lookup(name)
  return Rootkit.rootkit_name_map[name]
end

return Rootkit