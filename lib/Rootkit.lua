require "lib.util"

local Rootkit = {}
Rootkit.__index = Rootkit
Rootkit.rootkit_name_version_map = {}
Rootkit.all = {}

function Rootkit.new(name, version)
  local self = setmetatable({}, Rootkit)
  self.name = name
  self.version = version
  self.outcome = nil
  Rootkit.all[#(Rootkit.all)+1] = self
  if Rootkit.rootkit_name_version_map[name] == nil then
    Rootkit.rootkit_name_version_map[name] = {}
  end
  Rootkit.rootkit_name_version_map[name][version] = self
  return self
end

function Rootkit.lookup(name, version)
  return Rootkit.rootkit_name_version_map[name][version]
end

return Rootkit