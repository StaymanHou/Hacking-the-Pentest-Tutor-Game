require "lib.util"

local Network = {}
Network.__index = Network

function Network.new(CIDR)
  local self = setmetatable({}, Network)
  local splited_cidr = CIDR:split("/")
  self.routing_prefix_bits = tonumber(splited_cidr[2])
  self.network_prefix = get_network_prefix(splited_cidr[1], self.routing_prefix_bits)
  self.CIDR = number_to_ip(self.network_prefix) .. "/" .. tostring(self.routing_prefix_bits)
  self.connected_network_interfaces = {}
  return self
end

function Network:get_cidr()
  return self.CIDR
end

function Network:has_ip(ip)
  if self.network_prefix == get_network_prefix(ip, self.routing_prefix_bits) then
    return true
  else
    return false
  end
end

function Network:to_json()
  network = {}
  network.CIDR = self.CIDR
  return network
end

return Network
