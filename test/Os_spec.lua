require "lunit"
local Os = require "lib.Os"

module( "Os_testcase", package.seeall, lunit.testcase )

function test_load_function()
  Os.os_name_version_map = {}
  Os.all = {}
  assert_not_equal( 0, #(Os.load()) )
end

function test_new_method()
  Os.os_name_version_map = {}
  Os.all = {}
  assert_not_nil( Os.new("Stayman OS", "0.0.1") )
end

function test_lookup_method()
  Os.os_name_version_map = {}
  Os.all = {}
  Os.new("Stayman OS", "0.0.1")
  assert_equal( 0, #(Os.lookup("Stayman OS", "0.0.1").vulnerabilities) )
end
