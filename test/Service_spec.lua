require "lunit"
local Service = require "lib.Service"

module( "Service_testcase", package.seeall, lunit.testcase )

function test_load_function()
  Service.service_name_version_map = {}
  Service.all = {}
  assert_not_equal( 0, #(Service.load()) )
end

function test_new_method()
  Service.service_name_version_map = {}
  Service.all = {}
  assert_not_nil( Service.new("Stayman ServEngine", "0.0.1") )
end

function test_lookup_method()
  Service.service_name_version_map = {}
  Service.all = {}
  Service.new("Stayman ServEngine", "0.0.1")
  assert_equal( 0, #(Service.lookup("Stayman ServEngine", "0.0.1").vulnerabilities) )
end
