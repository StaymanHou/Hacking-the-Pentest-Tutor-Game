require "lunit"
local Network = require "lib.Network"

module( "Network_testcase", package.seeall, lunit.testcase )

function test_get_network_prefix_function()
  assert_equal( 16908288, get_network_prefix("1.2.3.4", 16) )
end

function test_network_prefix_to_ip_function()
  assert_equal( "1.2.0.0", network_prefix_to_ip(16908288) )
end

function test_new_method()
  assert_not_nil( Network.new("127.0.0.1/32") )
end

local network = Network.new("1.2.3.4/16")

function test_get_cidr_method()
  assert_equal( "1.2.0.0/16", network:get_cidr(), ":get_cidr() should return 1.2.0.0/16" )
end

function test_has_ip_method()
  assert_true( network:has_ip("1.2.4.3"), ":has_ip(\"1.2.4.3\") should return true" )
  assert_false( network:has_ip("1.3.2.3"), ":has_ip(\"1.3.2.4\") should return false" )
end
