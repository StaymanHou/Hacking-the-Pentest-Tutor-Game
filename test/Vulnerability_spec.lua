require "lunit"
local Vulnerability = require "lib.Vulnerability"

module( "Vulnerability_testcase", package.seeall, lunit.testcase )

function test_load_function()
  Vulnerability.vuln_id_map = {}
  Vulnerability.all = {}
  assert_equal( 78937, #(Vulnerability.load()) )
end

function test_new_method()
  Vulnerability.vuln_id_map = {}
  Vulnerability.all = {}
  assert_not_nil( Vulnerability.new("CVE-0000", "no description") )
end

function test_lookup_method()
  Vulnerability.vuln_id_map = {}
  Vulnerability.all = {}
  Vulnerability.new("CVE-0000", "no description")
  assert_equal( "no description", Vulnerability.lookup("CVE-0000").description)
end
