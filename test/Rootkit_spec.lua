require "lunit"
local Rootkit = require "lib.Rootkit"

module( "Rootkit_testcase", package.seeall, lunit.testcase )

function test_new_method()
  Rootkit.rootkit_name_version_map = {}
  Rootkit.all = {}
  assert_not_nil( Rootkit.new("Stayman Rootkit", "0.0.1") )
end

function test_lookup_method()
  Rootkit.rootkit_name_version_map = {}
  Rootkit.all = {}
  Rootkit.new("Stayman Rootkit", "0.0.1")
  assert_equal( nil, Rootkit.lookup("Stayman Rootkit", "0.0.1").outcome )
end
