if Action == nil then
  Action = require "lib.Action"
end
if Outcome == nil then
  Outcome = require "lib.Outcome"
end
if Configuration == nil then
  Configuration = require "lib.Configuration"
end

conf_ruwp = Configuration.lookup("root user weak password")
conf_rrule = Configuration.lookup("remote root user login enabled")
conf_rlwpe = Configuration.lookup("remote login with password enabled")

medusa = Action.new("medusa -M ssh")
medusa.outcome = Outcome.lookup("get ssh login")
medusa.target_configurations[#(medusa.target_configurations)+1] = conf_ruwp
medusa.target_configurations[#(medusa.target_configurations)+1] = conf_rrule
medusa.target_configurations[#(medusa.target_configurations)+1] = conf_rlwpe
medusa.run = function (self, src_host, target_ip)
  target_host = src_host:get_reachable_host_by_ip(target_ip)
  if target_host == nil then
    return "Destination not reachable!"
  end
  flag_ssh_port_open_n_service_listenning = false
  for _, addr_port_listenning_service in ipairs(target_host.addr_port_listenning_services) do
    if addr_port_listenning_service.network_interface.ip == target_ip and addr_port_listenning_service.protocol == "tcp" and addr_port_listenning_service.port == 22 and addr_port_listenning_service.service.name == "OpenSSH" then
      
    end
  end
  target = { host = target_host, ip = target_ip }
  return self.outcome.eval(target)
end