if Action == nil then
  Action = require "lib.Action"
end
if Outcome == nil then
  Outcome = require "lib.Outcome"
end

ping = Action.new("ping")
ping.outcome = Outcome.lookup("discover reachable host")
ping.run = function (self, src_host, target_ip)
  target_host = src_host:get_reachable_host_by_ip(target_ip)
  if target_host == nil then
    return "Destination not reachable!"
  else
    target = { host = target_host, ip = target_ip }
    return self.outcome.eval(target)
  end
end

ping.get_avaliable_targets = function (self, observed_map)
  local targets = {}
  for _,host in ipairs(observed_map.hosts) do
    for _,nic in ipairs(host.network_interfaces) do
      targets[#(targets)+1] = nic.ip
    end
  end
  return targets
end