if Outcome == nil then
  Outcome = require "lib.Outcome"
end
if dns_resolver == nil then
  dns_resolver = require "lib.dns_resolver"
end

check_network_interfaces = Outcome.new("check network interfaces")
check_network_interfaces.eval = function (target_host)
  return_str = "lo\tinet addr:127.0.0.1  Mask:255.0.0.0\n"
  for index, network_interface in ipairs(target_host.network_interfaces) do
    return_str = return_str .. "eth" .. (index - 1) .. "\tinet addr:" .. network_interface.ip .. "  Mask:" .. network_interface.network:get_mask() .. "\n\n"
  end
  return return_str
end
